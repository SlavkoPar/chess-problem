!function(){"use strict";var e={505:function(e,n,r){for(var t=r(762),a=r(62),o=[["a8","b8","c8","d8","e8","f8","g8","h8"],["a7","b7","c7","d7","e7","f7","g7","h7"],["a6","b6","c6","d6","e6","f6","g6","h6"],["a5","b5","c5","d5","e5","f5","g5","h5"],["a4","b4","c4","d4","e4","f4","g4","h4"],["a3","b3","c3","d3","e3","f3","g3","h3"],["a2","b2","c2","d2","e2","f2","g2","h2"],["a1","b1","c1","d1","e1","f1","g1","h1"]],f={1:"45678",2:"5678",3:"678",4:"78",5:"8"},i={a:"defgh",b:"efgh",c:"fgh",d:"gh",e:"h"},c="abcdefgh",s=function(e){for(var n=e.map((function(e){return e.charAt(1)})).sort(),r=0;r<n.length-1;r++)if(!["6","7","8"].includes(n[r])&&f[n[r]].includes(n[r+1]))return!0;for(var t=e.map((function(e){return e.charAt(0)})).sort(),a=0;a<t.length-1;a++)if(!["f","g","h"].includes(t[a])&&i[t[a]].includes(t[a+1]))return!0;return!1},l=function(e,n){var r=Math.max.apply(Math,(0,a.Z)(e.map((function(e){return parseInt(e.charAt(1))})))),t=Math.min.apply(Math,(0,a.Z)(n.map((function(e){return parseInt(e.charAt(1))}))));if(Math.abs(r-t)>1)return!0;var o=Math.max.apply(Math,(0,a.Z)(e.map((function(e){return c.indexOf(e.charAt(0))})))),f=Math.min.apply(Math,(0,a.Z)(n.map((function(e){return c.indexOf(e.charAt(0))}))));return Math.abs(o-f)>1},u=[["a1","b2","c3","d4","e5","f6","g7","h8"],["a2","b3","c4","d5","e6","f7","g8"],["a3","b4","c5","d6","e7","f8"],["a4","b5","c6","d7","e8"],["a5","b6","c7","d8"],["a6","b7","c8"],["a7","b8"],["b1","c2","d3","e4","f5","g6","h7"],["c1","d2","e3","f4","g5","h6"],["d1","e2","f3","g4","h5"],["e1","f2","g3","h4"],["f1","g2","h3"],["g1","h2"]],h=[["h1","g2","f3","e4","d5","c6","b7","a8"],["h2","g3","f4","e5","d6","c7","b8"],["h3","g4","f5","e6","d7","c8"],["h4","g5","f6","e7","d8"],["h5","g6","f7","e8"],["h6","g7","f8"],["h7","g8"],["g1","f2","e3","d4","c5","b6","a7"],["f1","e2","d3","c4","b5","a6"],["e1","d2","c3","b4","a5"],["d1","c2","b3","a4"],["c1","b2","a3"],["b1","a2"]],d={},v=0,p=["1","2","3","4","5","6","7","8"];v<p.length;v++)for(var g=p[v],b=function(){var e=y[m]+g;d[e]=[];var n,r=(0,t.Z)(u);try{for(r.s();!(n=r.n()).done;){var o,f=n.value;f.includes(e)&&(o=d[e]).push.apply(o,(0,a.Z)(f.filter((function(n){return n!==e}))))}}catch(v){r.e(v)}finally{r.f()}var i,c=(0,t.Z)(h);try{for(c.s();!(i=c.n()).done;){var s,l=i.value;l.includes(e)&&(s=d[e]).push.apply(s,(0,a.Z)(l.filter((function(n){return n!==e}))))}}catch(v){c.e(v)}finally{c.f()}},m=0,y=["a","b","c","d","e","f","g","h"];m<y.length;m++)b();var M=function(e,n){for(var r=null,t=null,a=0;a<8&&(!r||!t);a++)for(var o=e[a],f=0;f<8&&(!r||!t);f++)if(o[f]){var i=o[f],s=i.type,l=i.color,u=i.square;s===n&&"w"===l?r=u:"n"===s&&"w"===l&&(t=u)}if(!t||!r)return!1;var h,v=parseInt(r.charAt(1)),p=c.indexOf(r.charAt(0)),g=parseInt(t.charAt(1)),b=c.indexOf(t.charAt(0)),m=p===b&&(2===Math.abs(v-g)||4===Math.abs(v-g))||v===g&&(2===Math.abs(p-b)||4===Math.abs(p-b));return m||(h=t,m=d[r].includes(h)),m},O=r(984).Chess,x=new RegExp("[#+]$"),k=new RegExp("#$"),w=[];self.onmessage=function(e){var n=JSON.parse(e.data),r=n.pieces,f=n.whiteSquareBishops,i=n.fromSquare,c=n.nSquares,u=n.testFen,h=u?new O(u):new O;u||h.clear();var d=0,v=r.includes("Q")&&r.includes("N");v&&d++;var p=r.includes("B")&&r.includes("N");p&&d++;for(var g=0,b=0;b<o.length&&-1===(g=o[b].indexOf(i));b++);for(var m=g+c,y=[],Z=0;Z<c-b;Z++)y.push.apply(y,(0,a.Z)(o[b+Z].slice(g,m)));var A=function(e){return!(!v||!M(e,"q"))||!(!p||!M(e,"b"))},S=function(){var e,n=h.moves().filter((function(e){return!x.test(e)&&!e.includes("x")})),r=0,a=null,o=!1,f=(0,t.Z)(n);try{for(f.s();!(e=f.n()).done;){var i=e.value;h.move(i);var c=h.moves(),s=0;o=!1;var l,v=(0,t.Z)(c);try{for(v.s();!(l=v.n()).done;){var p=l.value;h.move(p);var g=h.moves().filter((function(e){return k.test(e)&&!(e.includes("=Q")||e.includes("=R"))}));if((s=g.length)>0&&d>0){var b,m=(0,t.Z)(g);try{for(m.s();!(b=m.n()).done;){var y=b.value;if(h.move(y),A(h.board())&&(o=!0,console.log("black:",p," white2:",y)),h.undo(),o)break}}catch(M){m.e(M)}finally{m.f()}}if(h.undo(),0===s)break}}catch(M){v.e(M)}finally{v.f()}s>0&&(0===d||o)&&(u&&console.log("checkmate at second move",i),r++,a=i,console.log("firstMove:",a)),h.undo()}}catch(M){f.e(M)}finally{f.f()}return u&&console.log(1===r?"Position is problem":"Position is not problem"),1===r?a:null},j=n.pieces.indexOf("k"),q=null;if(""===i)console.log("Invalid fromSquare");else if(u){console.time();var C=S(),P={fen:u,firstMove:C};self.postMessage(JSON.stringify(P)),console.timeEnd()}else!function e(n,r){var o,i=n.shift().charAt(0),c=i.toLowerCase(),u=/[RNBKQP]/.test(i)?"w":"b",d="k"===i,v="b"===c,p=v&&f[r],g=(0,t.Z)(y);try{for(g.s();!(o=g.n()).done;){var b=o.value;if(!w.includes(b)&&("p"!==c||!b.includes("8")&&!b.includes("1"))){var m=h.put({type:c,color:u},b);if(h.isCheck()||d&&(h.isAttacked(b,"w")||b.endsWith("1")||b.endsWith("8")||b.startsWith("a")||b.startsWith("h")||"b"===u&&h.isAttacked(w[0],"b"))||v&&(p&&"dark"===h.squareColor(b)||!p&&"light"===h.squareColor(b)))h.remove(b);else if(m){var M=!1,O=!1,x=!1;if(d&&(q=null),w.push(b),r>0&&r<j){var k=w.slice(0,w.length);M=s(k)}else if(r>=j){var Z=w.slice(j,w.length);if(Z.length>1&&(O=s(Z)),!O){var A=w.slice(0,j);O=l(A,Z)}r===j&&(x=h.isAttacked(b,"w"))}if(!M&&!O&&!x)if(0===n.length){var C=h.fen(),P=S();null!==P&&(P===q||P.endsWith("=Q")||P.endsWith("=R")?P=null:(q=P,console.log("------",w,"---",C)));var N={fen:C,firstMove:P};self.postMessage(JSON.stringify(N))}else e((0,a.Z)(n),r+1);w.pop(),h.remove(b)}}}}catch(W){g.e(W)}finally{g.f()}}((0,a.Z)(n.pieces),0)}}},n={};function r(t){var a=n[t];if(void 0!==a)return a.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.m=e,r.x=function(){var e=r.O(void 0,[777],(function(){return r(505)}));return e=r.O(e)},function(){var e=[];r.O=function(n,t,a,o){if(!t){var f=1/0;for(l=0;l<e.length;l++){t=e[l][0],a=e[l][1],o=e[l][2];for(var i=!0,c=0;c<t.length;c++)(!1&o||f>=o)&&Object.keys(r.O).every((function(e){return r.O[e](t[c])}))?t.splice(c--,1):(i=!1,o<f&&(f=o));if(i){e.splice(l--,1);var s=a();void 0!==s&&(n=s)}}return n}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[t,a,o]}}(),r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(n,t){return r.f[t](e,n),n}),[]))},r.u=function(e){return"static/js/"+e+".0e9f84b3.chunk.js"},r.miniCssF=function(e){},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/chess-problem/",function(){var e={505:1};r.f.i=function(n,t){e[n]||importScripts(r.p+r.u(n))};var n=self.webpackChunkchess_game=self.webpackChunkchess_game||[],t=n.push.bind(n);n.push=function(n){var a=n[0],o=n[1],f=n[2];for(var i in o)r.o(o,i)&&(r.m[i]=o[i]);for(f&&f(r);a.length;)e[a.pop()]=1;t(n)}}(),function(){var e=r.x;r.x=function(){return r.e(777).then(e)}}();r.x()}();
//# sourceMappingURL=505.348c4069.chunk.js.map