!function(){"use strict";var e={505:function(e,n,r){for(var t=r(762),a=r(62),o=[["a8","b8","c8","d8","e8","f8","g8","h8"],["a7","b7","c7","d7","e7","f7","g7","h7"],["a6","b6","c6","d6","e6","f6","g6","h6"],["a5","b5","c5","d5","e5","f5","g5","h5"],["a4","b4","c4","d4","e4","f4","g4","h4"],["a3","b3","c3","d3","e3","f3","g3","h3"],["a2","b2","c2","d2","e2","f2","g2","h2"],["a1","b1","c1","d1","e1","f1","g1","h1"]],f="abcdefgh",i=function(e){for(var n=e.map((function(e){return e.i})).sort(),r=0;r<n.length-1;r++)if(n[r+1]-n[r]>1)return!0;n=e.map((function(e){return e.j})).sort();for(var t=0;t<n.length-1;t++)if(n[t+1]-n[t]>1)return!0;return!1},c=9,s=-1,u=9,l=-1,h=function(e){var n,r=(0,t.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value,o=a.i,f=a.j;o<c&&(c=o),o>s&&(s=o),f<u&&(u=f),f>l&&(l=f)}}catch(i){r.e(i)}finally{r.f()}},d=function(e){var n,r=(0,t.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value,o=a.i,f=a.j;if(o>=c&&o<=s&&f>=u&&f<=l)return!0}}catch(i){r.e(i)}finally{r.f()}return!1},v=function(e,n){var r=Math.max.apply(Math,(0,a.Z)(e.map((function(e){return e.i})))),t=Math.min.apply(Math,(0,a.Z)(n.map((function(e){return e.i}))));if(Math.abs(r-t)>1)return!0;var o=Math.max.apply(Math,(0,a.Z)(e.map((function(e){return e.j})))),f=Math.min.apply(Math,(0,a.Z)(n.map((function(e){return e.j}))));return Math.abs(o-f)>1},p=[["a1","b2","c3","d4","e5","f6","g7","h8"],["a2","b3","c4","d5","e6","f7","g8"],["a3","b4","c5","d6","e7","f8"],["a4","b5","c6","d7","e8"],["a5","b6","c7","d8"],["a6","b7","c8"],["a7","b8"],["b1","c2","d3","e4","f5","g6","h7"],["c1","d2","e3","f4","g5","h6"],["d1","e2","f3","g4","h5"],["e1","f2","g3","h4"],["f1","g2","h3"],["g1","h2"]],g=[["h1","g2","f3","e4","d5","c6","b7","a8"],["h2","g3","f4","e5","d6","c7","b8"],["h3","g4","f5","e6","d7","c8"],["h4","g5","f6","e7","d8"],["h5","g6","f7","e8"],["h6","g7","f8"],["h7","g8"],["g1","f2","e3","d4","c5","b6","a7"],["f1","e2","d3","c4","b5","a6"],["e1","d2","c3","b4","a5"],["d1","c2","b3","a4"],["c1","b2","a3"],["b1","a2"]],b={},m=0,y=["1","2","3","4","5","6","7","8"];m<y.length;m++)for(var M=y[m],O=function(){var e=k[x]+M;b[e]=[];var n,r=(0,t.Z)(p);try{for(r.s();!(n=r.n()).done;){var o,f=n.value;f.includes(e)&&(o=b[e]).push.apply(o,(0,a.Z)(f.filter((function(n){return n!==e}))))}}catch(l){r.e(l)}finally{r.f()}var i,c=(0,t.Z)(g);try{for(c.s();!(i=c.n()).done;){var s,u=i.value;u.includes(e)&&(s=b[e]).push.apply(s,(0,a.Z)(u.filter((function(n){return n!==e}))))}}catch(l){c.e(l)}finally{c.f()}},x=0,k=["a","b","c","d","e","f","g","h"];x<k.length;x++)O();var Z=function(e,n){for(var r=null,t=null,a=0;a<8&&(!r||!t);a++)for(var o=e[a],i=0;i<8&&(!r||!t);i++)if(o[i]){var c=o[i],s=c.type,u=c.color,l=c.square;s===n&&"w"===u?r=l:"n"===s&&"w"===u&&(t=l)}if(!t||!r)return!1;var h,d=parseInt(r.charAt(1)),v=f.indexOf(r.charAt(0)),p=parseInt(t.charAt(1)),g=f.indexOf(t.charAt(0)),m=v===g&&(2===Math.abs(d-p)||4===Math.abs(d-p))||d===p&&(2===Math.abs(v-g)||4===Math.abs(v-g));return m||(h=t,m=b[r].includes(h)),m},j=r(984).Chess,w=new RegExp("[#+]$"),S=new RegExp("#$"),A=[];self.onmessage=function(e){var n=JSON.parse(e.data),r=n.pieces,c=n.whiteSquareBishops,s=n.fromSquare,u=n.nSquares,l=n.testFen,p=l?new j(l):new j;l||p.clear();var g=0,b=r.includes("Q")&&r.includes("N");b&&g++;var m=r.includes("B")&&r.includes("N");m&&g++;for(var y=0,M=0;M<o.length&&-1===(y=o[M].indexOf(s));M++);for(var O=y+u,x=[],k=0;k<u-M;k++)x.push.apply(x,(0,a.Z)(o[M+k].slice(y,O)));var q=function(e){return!(!b||!Z(e,"q"))||!(!m||!Z(e,"b"))},C=n.pieces.indexOf("k"),P=function(){var e,n=p.moves().filter((function(e){return!w.test(e)&&!e.includes("x")})),r=0,a=null,o=!1,f=(0,t.Z)(n);try{for(f.s();!(e=f.n()).done;){var i=e.value;p.move(i);var c=p.moves(),s=0;o=!1;var u,h=(0,t.Z)(c);try{for(h.s();!(u=h.n()).done;){var d=u.value;p.move(d);var v=p.moves().filter((function(e){return S.test(e)&&!(e.includes("=Q")||e.includes("=R"))}));if((s=v.length)>0&&g>0){var b,m=(0,t.Z)(v);try{for(m.s();!(b=m.n()).done;){var y=b.value;if(p.move(y),q(p.board())&&(o=!0,console.log("black:",d," white2:",y)),p.undo(),o)break}}catch(M){m.e(M)}finally{m.f()}}if(p.undo(),0===s)break}}catch(M){h.e(M)}finally{h.f()}s>0&&(0===g||o)&&(l&&console.log("checkmate at second move",i),r++,a=i,console.log("firstMove:",a)),p.undo()}}catch(M){f.e(M)}finally{f.f()}return l&&console.log(1===r?"Position is problem":"Position is not problem"),1===r?a:null},N=[],W=[],I=null;if(""===s)console.log("Invalid fromSquare");else if(l){console.time();var R=P(),Q={fen:l,firstMove:R};self.postMessage(JSON.stringify(Q)),console.timeEnd()}else!function e(n,r){var o,s=n.shift().charAt(0),u=s.toLowerCase(),l=/[RNBKQP]/.test(s)?"w":"b",g="k"===s,b="b"===u,m=b&&c[r],y=(0,t.Z)(x);try{for(y.s();!(o=y.n()).done;){var M=o.value;if(!A.includes(M)&&("p"!==u||!M.includes("8")&&!M.includes("1"))){var O=p.put({type:u,color:l},M);if(p.isCheck()||g&&(p.isAttacked(M,"w")||M.endsWith("1")||M.endsWith("8")||M.startsWith("a")||M.startsWith("h")||"b"===l&&p.isAttacked(A[0],"b"))||b&&(m&&"dark"===p.squareColor(M)||!m&&"light"===p.squareColor(M)))p.remove(M);else if(O){var k=!1,Z=!1,j=!1;if(g&&(I=null,h(N)),A.push(M),r<C?N.push({i:parseInt(M.charAt(1)),j:f.indexOf(M.charAt(0))}):W.push({i:parseInt(M.charAt(1)),j:f.indexOf(M.charAt(0))}),r>0&&r<C?k=i(N):r>=C&&(W.length>1&&(Z=i(W)),Z||(Z=v(N,W)),r===C&&(j=p.isAttacked(M,"w"))),!k&&!Z&&!j)if(0===n.length){if(d(W)){var w=p.fen(),S=P();null!==S&&(S===I||S.endsWith("=Q")||S.endsWith("=R")?S=null:(I=S,console.log("------",A,"---",w)));var q={fen:w,firstMove:S};self.postMessage(JSON.stringify(q))}}else e((0,a.Z)(n),r+1);A.pop(),r<C?N.pop():W.pop(),p.remove(M)}}}}catch(R){y.e(R)}finally{y.f()}}((0,a.Z)(n.pieces),0)}}},n={};function r(t){var a=n[t];if(void 0!==a)return a.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.m=e,r.x=function(){var e=r.O(void 0,[777],(function(){return r(505)}));return e=r.O(e)},function(){var e=[];r.O=function(n,t,a,o){if(!t){var f=1/0;for(u=0;u<e.length;u++){t=e[u][0],a=e[u][1],o=e[u][2];for(var i=!0,c=0;c<t.length;c++)(!1&o||f>=o)&&Object.keys(r.O).every((function(e){return r.O[e](t[c])}))?t.splice(c--,1):(i=!1,o<f&&(f=o));if(i){e.splice(u--,1);var s=a();void 0!==s&&(n=s)}}return n}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[t,a,o]}}(),r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(n,t){return r.f[t](e,n),n}),[]))},r.u=function(e){return"static/js/"+e+".0e9f84b3.chunk.js"},r.miniCssF=function(e){},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/chess-problem/",function(){var e={505:1};r.f.i=function(n,t){e[n]||importScripts(r.p+r.u(n))};var n=self.webpackChunkchess_game=self.webpackChunkchess_game||[],t=n.push.bind(n);n.push=function(n){var a=n[0],o=n[1],f=n[2];for(var i in o)r.o(o,i)&&(r.m[i]=o[i]);for(f&&f(r);a.length;)e[a.pop()]=1;t(n)}}(),function(){var e=r.x;r.x=function(){return r.e(777).then(e)}}();r.x()}();
//# sourceMappingURL=505.da4b5527.chunk.js.map