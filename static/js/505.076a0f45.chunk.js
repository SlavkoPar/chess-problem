!function(){"use strict";var e={505:function(e,n,r){for(var t=r(762),a=r(62),f=[["a8","b8","c8","d8","e8","f8","g8","h8"],["a7","b7","c7","d7","e7","f7","g7","h7"],["a6","b6","c6","d6","e6","f6","g6","h6"],["a5","b5","c5","d5","e5","f5","g5","h5"],["a4","b4","c4","d4","e4","f4","g4","h4"],["a3","b3","c3","d3","e3","f3","g3","h3"],["a2","b2","c2","d2","e2","f2","g2","h2"],["a1","b1","c1","d1","e1","f1","g1","h1"]],o={1:"45678",2:"5678",3:"678",4:"78",5:"8"},i={a:"defgh",b:"efgh",c:"fgh",d:"gh",e:"h"},c="abcdefgh",s=function(e){for(var n=e.map((function(e){return e.charAt(1)})).sort(),r=0;r<n.length-1;r++)if(!["6","7","8"].includes(n[r])&&o[n[r]].includes(n[r+1]))return!0;for(var t=e.map((function(e){return e.charAt(0)})).sort(),a=0;a<t.length-1;a++)if(!["f","g","h"].includes(t[a])&&i[t[a]].includes(t[a+1]))return!0;return!1},u=function(e,n){for(var r=9,t=-1,a=9,f=-1,o=n;o<e.length;o++){var i=e[o],s=parseInt(i.charAt(1)),u=c.indexOf(i.charAt(0));s<r&&(r=s),s>t&&(t=s),u<a&&(a=u),u>f&&(f=u)}for(var l=0;l<n;l++){var h=e[l],d=parseInt(h.charAt(1)),v=c.indexOf(h.charAt(0));if(d>=r&&d<=t&&v>=a&&v<=f)return!0}return!1},l=function(e,n){var r=Math.max.apply(Math,(0,a.Z)(e.map((function(e){return parseInt(e.charAt(1))})))),t=Math.min.apply(Math,(0,a.Z)(n.map((function(e){return parseInt(e.charAt(1))}))));if(Math.abs(r-t)>1)return!0;var f=Math.max.apply(Math,(0,a.Z)(e.map((function(e){return c.indexOf(e.charAt(0))})))),o=Math.min.apply(Math,(0,a.Z)(n.map((function(e){return c.indexOf(e.charAt(0))}))));return Math.abs(f-o)>1},h=[["a1","b2","c3","d4","e5","f6","g7","h8"],["a2","b3","c4","d5","e6","f7","g8"],["a3","b4","c5","d6","e7","f8"],["a4","b5","c6","d7","e8"],["a5","b6","c7","d8"],["a6","b7","c8"],["a7","b8"],["b1","c2","d3","e4","f5","g6","h7"],["c1","d2","e3","f4","g5","h6"],["d1","e2","f3","g4","h5"],["e1","f2","g3","h4"],["f1","g2","h3"],["g1","h2"]],d=[["h1","g2","f3","e4","d5","c6","b7","a8"],["h2","g3","f4","e5","d6","c7","b8"],["h3","g4","f5","e6","d7","c8"],["h4","g5","f6","e7","d8"],["h5","g6","f7","e8"],["h6","g7","f8"],["h7","g8"],["g1","f2","e3","d4","c5","b6","a7"],["f1","e2","d3","c4","b5","a6"],["e1","d2","c3","b4","a5"],["d1","c2","b3","a4"],["c1","b2","a3"],["b1","a2"]],v={},p=0,g=["1","2","3","4","5","6","7","8"];p<g.length;p++)for(var b=g[p],m=function(){var e=O[y]+b;v[e]=[];var n,r=(0,t.Z)(h);try{for(r.s();!(n=r.n()).done;){var f,o=n.value;o.includes(e)&&(f=v[e]).push.apply(f,(0,a.Z)(o.filter((function(n){return n!==e}))))}}catch(l){r.e(l)}finally{r.f()}var i,c=(0,t.Z)(d);try{for(c.s();!(i=c.n()).done;){var s,u=i.value;u.includes(e)&&(s=v[e]).push.apply(s,(0,a.Z)(u.filter((function(n){return n!==e}))))}}catch(l){c.e(l)}finally{c.f()}},y=0,O=["a","b","c","d","e","f","g","h"];y<O.length;y++)m();var x=function(e,n){for(var r=null,t=null,a=0;a<8&&(!r||!t);a++)for(var f=e[a],o=0;o<8&&(!r||!t);o++)if(f[o]){var i=f[o],s=i.type,u=i.color,l=i.square;s===n&&"w"===u?r=l:"n"===s&&"w"===u&&(t=l)}if(!t||!r)return!1;var h,d=parseInt(r.charAt(1)),p=c.indexOf(r.charAt(0)),g=parseInt(t.charAt(1)),b=c.indexOf(t.charAt(0)),m=p===b&&(2===Math.abs(d-g)||4===Math.abs(d-g))||d===g&&(2===Math.abs(p-b)||4===Math.abs(p-b));return m||(h=t,m=v[r].includes(h)),m},M=r(984).Chess,k=new RegExp("[#+]$"),A=new RegExp("#$"),w=[];self.onmessage=function(e){var n=JSON.parse(e.data),r=n.pieces,o=n.whiteSquareBishops,i=n.fromSquare,c=n.nSquares,h=n.testFen,d=h?new M(h):new M;h||d.clear();var v=0,p=r.includes("Q")&&r.includes("N");p&&v++;var g=r.includes("B")&&r.includes("N");g&&v++;for(var b=0,m=0;m<f.length&&-1===(b=f[m].indexOf(i));m++);for(var y=b+c,O=[],Z=0;Z<c-m;Z++)O.push.apply(O,(0,a.Z)(f[m+Z].slice(b,y)));var S=function(e){return!(!p||!x(e,"q"))||!(!g||!x(e,"b"))},j=n.pieces.indexOf("k"),q=function(){var e,n=d.moves().filter((function(e){return!k.test(e)&&!e.includes("x")})),r=0,a=null,f=!1,o=(0,t.Z)(n);try{for(o.s();!(e=o.n()).done;){var i=e.value;d.move(i);var c=d.moves(),s=0;f=!1;var u,l=(0,t.Z)(c);try{for(l.s();!(u=l.n()).done;){var p=u.value;d.move(p);var g=d.moves().filter((function(e){return A.test(e)&&!(e.includes("=Q")||e.includes("=R"))}));if((s=g.length)>0&&v>0){var b,m=(0,t.Z)(g);try{for(m.s();!(b=m.n()).done;){var y=b.value;if(d.move(y),S(d.board())&&(f=!0,console.log("black:",p," white2:",y)),d.undo(),f)break}}catch(O){m.e(O)}finally{m.f()}}if(d.undo(),0===s)break}}catch(O){l.e(O)}finally{l.f()}s>0&&(0===v||f)&&(h&&console.log("checkmate at second move",i),r++,a=i,console.log("firstMove:",a)),d.undo()}}catch(O){o.e(O)}finally{o.f()}return h&&console.log(1===r?"Position is problem":"Position is not problem"),1===r?a:null},C=null;if(""===i)console.log("Invalid fromSquare");else if(h){console.time();var P=q(),I={fen:h,firstMove:P};self.postMessage(JSON.stringify(I)),console.timeEnd()}else!function e(n,r){var f,i=n.shift().charAt(0),c=i.toLowerCase(),h=/[RNBKQP]/.test(i)?"w":"b",v="k"===i,p="b"===c,g=p&&o[r],b=(0,t.Z)(O);try{for(b.s();!(f=b.n()).done;){var m=f.value;if(!w.includes(m)&&("p"!==c||!m.includes("8")&&!m.includes("1"))){var y=d.put({type:c,color:h},m);if(d.isCheck()||v&&(d.isAttacked(m,"w")||m.endsWith("1")||m.endsWith("8")||m.startsWith("a")||m.startsWith("h")||"b"===h&&d.isAttacked(w[0],"b"))||p&&(g&&"dark"===d.squareColor(m)||!g&&"light"===d.squareColor(m)))d.remove(m);else if(y){var x=!1,M=!1,k=!1;if(v&&(C=null),w.push(m),r>0&&r<j){var A=w.slice(0,w.length);x=s(A)}else if(r>=j){var Z=w.slice(j,w.length);if(Z.length>1&&(M=s(Z)),!M){var S=w.slice(0,j);M=l(S,Z)}r===j&&(k=d.isAttacked(m,"w"))}if(!x&&!M&&!k)if(0===n.length){if(u(w,j)){var P=d.fen(),I=q();null!==I&&(I===C||I.endsWith("=Q")||I.endsWith("=R")?I=null:(C=I,console.log("------",w,"---",P)));var N={fen:P,firstMove:I};self.postMessage(JSON.stringify(N))}}else e((0,a.Z)(n),r+1);w.pop(),d.remove(m)}}}}catch(W){b.e(W)}finally{b.f()}}((0,a.Z)(n.pieces),0)}}},n={};function r(t){var a=n[t];if(void 0!==a)return a.exports;var f=n[t]={exports:{}};return e[t](f,f.exports,r),f.exports}r.m=e,r.x=function(){var e=r.O(void 0,[777],(function(){return r(505)}));return e=r.O(e)},function(){var e=[];r.O=function(n,t,a,f){if(!t){var o=1/0;for(u=0;u<e.length;u++){t=e[u][0],a=e[u][1],f=e[u][2];for(var i=!0,c=0;c<t.length;c++)(!1&f||o>=f)&&Object.keys(r.O).every((function(e){return r.O[e](t[c])}))?t.splice(c--,1):(i=!1,f<o&&(o=f));if(i){e.splice(u--,1);var s=a();void 0!==s&&(n=s)}}return n}f=f||0;for(var u=e.length;u>0&&e[u-1][2]>f;u--)e[u]=e[u-1];e[u]=[t,a,f]}}(),r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(n,t){return r.f[t](e,n),n}),[]))},r.u=function(e){return"static/js/"+e+".0e9f84b3.chunk.js"},r.miniCssF=function(e){},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/chess-problem/",function(){var e={505:1};r.f.i=function(n,t){e[n]||importScripts(r.p+r.u(n))};var n=self.webpackChunkchess_game=self.webpackChunkchess_game||[],t=n.push.bind(n);n.push=function(n){var a=n[0],f=n[1],o=n[2];for(var i in f)r.o(f,i)&&(r.m[i]=f[i]);for(o&&o(r);a.length;)e[a.pop()]=1;t(n)}}(),function(){var e=r.x;r.x=function(){return r.e(777).then(e)}}();r.x()}();
//# sourceMappingURL=505.076a0f45.chunk.js.map